`<template>
  <div id="app">
    <div class="container">
      <h1>UV-Vis Spectrometer Simulation</h1>

      <b-card>
        <b-card-header>Detector Intensity</b-card-header>
        <b-card-body>
          <line-with-line
                  :chart-data = "datacollection"
                  :options = "options"
          ></line-with-line>
        </b-card-body>
        <b-card-footer>
          <b-button size="sm" class="mb-1" variant="info" @click="state.lamp ? stopLamp() : startLamp()">{{state.lamp ? 'Stop' : 'Start'}} Lamp</b-button>
          <b-button size="sm" variant="info" @click="test()">Test</b-button>
          <b-row class="mb-1">
            <b-col lg="4">
              <b-input-group size="sm" prepend="Integration Time" append="ms">
                <b-form-input v-model="state.integration" type="number" step="20"></b-form-input>
              </b-input-group>
            </b-col>
          </b-row>
          <div>
            <span v-if="state.lamp"><b-icon icon="brightness-high" variant="warning"></b-icon> Lamp On.</span>
            <span v-else><b-icon icon="brightness-alt-low-fill" variant="dark"></b-icon> Lamp Off.</span>
          </div>
          <div v-show="state.lamp">
            <span v-if="state.saturationWarning"><b-icon icon="exclamation-circle-fill" variant="danger"></b-icon> Detector Saturated.  Try changing the integration time.</span>
            <span v-else-if="state.lowLampWarning"><b-icon icon="exclamation-circle-fill" variant="danger"></b-icon> Signal is low which will result in a low signal-to-noise ratio.  Try changing the integration time.</span>
            <span v-else><b-icon icon="check-circle-fill" variant="success"></b-icon> Instrument Okay.</span>
          </div>
        </b-card-footer>
      </b-card>
    </div>

  </div>
</template>

<script>
  //import LineChart from '@/components/LineChart'
  import LineWithLine from "./components/LineWithLine";

  export default {
    name: 'App',
    components: {
      LineWithLine
    },
    data () {
      //The wavelengths are defined here and referenced in the returned object so that the length of this array can be referenced in the data object
      let wavelengths = [380, 380.9, 381.8, 382.7, 383.6, 384.5, 385.3, 386.2, 387.1, 388, 388.9, 389.8, 390.7, 391.6, 392.5, 393.4, 394.2, 395.1, 396, 396.9, 397.8, 398.7, 399.6, 400.5, 401.4, 402.3, 403.1, 404, 404.9, 405.8, 406.7, 407.6, 408.5, 409.4, 410.3, 411.2, 412, 412.9, 413.8, 414.7, 415.6, 416.5, 417.4, 418.3, 419.2, 420.1, 420.9, 421.8, 422.7, 423.6, 424.5, 425.4, 426.3, 427.2, 428.1, 429, 429.8, 430.7, 431.6, 432.5, 433.4, 434.3, 435.2, 436.1, 437, 437.8, 438.7, 439.6, 440.5, 441.4, 442.3, 443.2, 444.1, 445, 445.9, 446.7, 447.6, 448.5, 449.4, 450.3, 451.2, 452.1, 453, 453.9, 454.8, 455.6, 456.5, 457.4, 458.3, 459.2, 460.1, 461, 461.9, 462.8, 463.7, 464.5, 465.4, 466.3, 467.2, 468.1, 469, 469.9, 470.8, 471.7, 472.6, 473.4, 474.3, 475.2, 476.1, 477, 477.9, 478.8, 479.7, 480.6, 481.4, 482.3, 483.2, 484.1, 485, 485.9, 486.8, 487.7, 488.6, 489.5, 490.3, 491.2, 492.1, 493, 493.9, 494.8, 495.7, 496.6, 497.5, 498.4, 499.2, 500.1, 501, 501.9, 502.8, 503.7, 504.6, 505.5, 506.4, 507.3, 508.1, 509, 509.9, 510.8, 511.7, 512.6, 513.4, 514.2, 515, 515.8, 516.7, 517.5, 518.3, 519.1, 520, 520.8, 521.6, 522.4, 523.2, 524.1, 524.9, 525.7, 526.5, 527.3, 528.2, 529, 529.8, 530.6, 531.5, 532.3, 533.1, 533.9, 534.7, 535.6, 536.4, 537.2, 538, 538.9, 539.7, 540.5, 541.3, 542.1, 543, 543.8, 544.6, 545.4, 546.2, 547.1, 547.9, 548.7, 549.5, 550.4, 551.2, 552, 552.8, 553.6, 554.5, 555.3, 556.1, 556.9, 557.7, 558.6, 559.4, 560.2, 561, 561.9, 562.7, 563.5, 564.3, 565.1, 566, 566.8, 567.6, 568.4, 569.3, 570.1, 570.9, 571.7, 572.5, 573.4, 574.2, 575, 575.8, 576.6, 577.5, 578.3, 579.1, 579.9, 580.8, 581.6, 582.4, 583.2, 584, 584.9, 585.7, 586.5, 587.3, 588.1, 588.9, 589.6, 590.4, 591.1, 591.8, 592.6, 593.3, 594.1, 594.8, 595.6, 596.3, 597.1, 597.8, 598.5, 599.3, 600, 600.8, 601.5, 602.3, 603, 603.7, 604.5, 605.2, 606, 606.7, 607.5, 608.2, 609, 609.7, 610.4, 611.2, 611.9, 612.7, 613.4, 614.2, 614.9, 615.7, 616.4, 617.1, 617.9, 618.6, 619.4, 620.1, 620.9, 621.6, 622.3, 623.1, 623.8, 624.6, 625.3, 626.1, 626.8, 627.6, 628.3, 629, 629.8, 630.5, 631.3, 632, 632.8, 633.5, 634.3, 635, 635.7, 636.5, 637.2, 638, 638.7, 639.5, 640.2, 640.9, 641.7, 642.4, 643.2, 643.9, 644.7, 645.4, 646.2, 646.9, 647.6, 648.4, 649.1, 649.9, 650.6, 651.4, 652.1, 652.9, 653.6, 654.3, 655.1, 655.8, 656.6, 657.3, 658.1, 658.8, 659.5, 660.3, 661, 661.8, 662.5, 663.3, 664, 664.8, 665.5, 666.2, 667, 667.8, 668.5, 669.3, 670, 670.8, 671.5, 672.3, 673.1, 673.8, 674.6, 675.3, 676.1, 676.8, 677.6, 678.4, 679.1, 679.9, 680.6, 681.4, 682.1, 682.9, 683.7, 684.4, 685.2, 685.9, 686.7, 687.4, 688.2, 689, 689.7, 690.5, 691.2, 692, 692.7, 693.5, 694.3, 695, 695.8, 696.5, 697.3, 698, 698.8, 699.6, 700.3, 701.1, 701.8, 702.6, 703.3, 704.1, 704.9, 705.6, 706.4, 707.1, 707.9, 708.7, 709.5, 710.3, 711, 711.8, 712.6, 713.4, 714.1, 714.9, 715.7, 716.5, 717.3, 718, 718.8, 719.6, 720.4, 721.2, 721.9, 722.7, 723.5, 724.3, 725.1, 725.8, 726.6, 727.4, 728.2, 728.9, 729.7, 730.5, 731.3, 732.1, 732.8, 733.6, 734.4, 735.2, 736, 736.7, 737.5, 738.3, 739.1, 739.8, 740.6, 741.4, 742.2, 743, 743.7, 744.5, 745.3, 746.1, 746.9, 747.6, 748.4, 749.2, 750, 750.8, 751.5, 752.3, 753.1, 753.9, 754.6, 755.4, 756.2, 757, 757.8, 758.5, 759.3, 760.1, 760.9, 761.7, 762.4, 763.2, 764, 764.8, 765.5, 766.3, 767.1, 767.9, 768.7, 769.4, 770.2, 771, 771.8, 772.6, 773.3, 774.1, 774.9, 775.7, 776.5, 777.2, 778, 778.8, 779.6, 780.3, 781.1, 781.9, 782.7, 783.5, 784.2, 785, 785.8, 786.6, 787.4, 788.1, 788.9, 789.7, 790.5, 791.2, 792, 792.8, 793.6, 794.4, 795.1, 795.9, 796.7, 797.5, 798.3, 799, 799.8, 800.6, 801.4, 802.2, 802.9, 803.7, 804.5, 805.3, 806, 806.8, 807.6, 808.4, 809.2, 809.9, 810.7, 811.5, 812.3, 813.1, 813.8, 814.6, 815.4, 816.2, 817, 817.7, 818.5, 819.3, 820.1, 820.8, 821.6, 822.4, 823.2, 824, 824.7, 825.5, 826.3, 827.1, 827.9, 828.6, 829.4, 830.2, 831, 831.8, 832.6, 833.5, 834.5, 835.4, 836.3, 837.2, 838.1, 839.1, 840, 840.9, 841.8, 842.8, 843.7, 844.6, 845.5, 846.5, 847.4, 848.3, 849.2, 850.1, 851.1, 852, 852.9, 853.8, 854.8, 855.7, 856.6, 857.5, 858.5, 859.4, 860.3, 861.2, 862.1, 863.1, 864, 864.9, 865.8, 866.8, 867.7, 868.6, 869.5, 870.5, 871.4, 872.3, 873.2, 874.1, 875.1, 876, 876.9, 877.8, 878.8, 879.7, 880.6, 881.5, 882.5, 883.4, 884.3, 885.2, 886.1, 887.1, 888, 888.9, 889.8, 890.8, 891.7, 892.6, 893.5, 894.5, 895.4, 896.3, 897.2, 898.1, 899.1, 900];
      return {
        selected: {
          lamp: 0,
          sample: 0,
        },
        state: {
          lamp: false,
          background: false,
          integration: 300,
          saturation: 3000,
          saturationWarning: false,
          lowLampWarning: false,
        },
        wavelengths: wavelengths,
        lamps: [{
          name: 'Tungsten-Halogen',
          intensity: [162.6874399, 165.9009741, 165.9130062, 165.1959181, 156.2199823, 159.6955167, 160.0986226, 157.9350012, 183.3122719, 178.8303201, 175.9238156, 175.9358477, 174.6528283, 165.6768925, 172.0909917, 180.7159551, 184.3581525, 185.9225929, 185.934625, 185.9466571, 185.9586892, 189.6926867, 204.1816758, 188.4930303, 222.2099421, 198.2270228, 216.8794293, 225.7051353, 225.7171674, 224.6109209, 221.6269637, 236.9376616, 232.9166777, 241.0877335, 243.0042134, 246.8520396, 250.9202987, 240.8208669, 274.4354077, 272.2004478, 270.9979497, 273.2569737, 275.324341, 269.3443945, 275.505447, 288.5185626, 292.8870604, 292.3631984, 286.3832518, 306.4578293, 301.9758774, 314.6927942, 312.8437529, 319.9931395, 340.3271374, 341.177954, 362.3747608, 381.9969047, 392.5130519, 386.5331054, 403.6490796, 423.5262554, 443.1483993, 444.2838511, 444.2958832, 440.5608712, 434.5809247, 454.2465321, 454.2585642, 474.3797126, 484.1968006, 493.9837342, 498.4897502, 502.9957663, 496.7270497, 489.7189729, 503.9329321, 503.9449641, 526.2492463, 553.2251821, 578.3724828, 562.2445906, 578.3753331, 576.4857807, 579.6617903, 620.5991105, 613.8701667, 657.3603969, 685.6053852, 667.4738183, 722.6867095, 738.1066866, 724.1170619, 789.068503, 785.7633253, 781.1657438, 808.6354487, 795.1655289, 834.9169699, 850.0317786, 836.5618588, 886.8898136, 906.5119575, 938.9070204, 924.4894983, 964.068765, 963.5695543, 971.0055948, 1015.952992, 1036.270378, 1060.36469, 1081.773095, 1121.613145, 1144.736818, 1153.567334, 1183.995874, 1258.416113, 1294.090666, 1347.782366, 1386.183765, 1367.942337, 1426.327942, 1461.333451, 1482.452542, 1521.175173, 1561.645425, 1594.957917, 1628.5882, 1648.856339, 1639.403171, 1687.510774, 1715.02894, 1719.695575, 1755.976546, 1757.635317, 1749.830928, 1770.100273, 1761.476472, 1803.727654, 1805.986678, 1808.245702, 1850.77722, 1818.644599, 1848.456201, 1837.664719, 1848.844159, 1859.653265, 1844.939838, 1860.680814, 1909.297662, 1882.395774, 1912.016253, 1950.312228, 1938.338966, 1954.047459, 1996.284335, 1988.432153, 2006.421988, 2019.117652, 2064.067522, 2076.062175, 2086.908216, 2108.173439, 2132.741265, 2174.424545, 2160.774772, 2204.736227, 2186.504466, 2217.180117, 2231.58161, 2251.724403, 2279.323441, 2258.363548, 2259.630316, 2273.707502, 2271.720871, 2269.342759, 2264.860807, 2260.87685, 2249.075382, 2235.770569, 2271.827047, 2277.82972, 2260.315184, 2264.289242, 2268.29459, 2270.236683, 2270.247379, 2270.258074, 2270.268769, 2270.279464, 2259.60904, 2246.304227, 2280.475228, 2282.664824, 2285.12812, 2267.274238, 2253.34823, 2289.379997, 2286.394703, 2298.632347, 2297.40376, 2309.818953, 2340.156973, 2324.216509, 2333.328379, 2355.975437, 2383.740094, 2362.793653, 2412.177277, 2418.179951, 2438.983224, 2462.961833, 2452.726633, 2503.069363, 2536.645103, 2538.842372, 2572.379416, 2553.498081, 2605.439257, 2629.885697, 2620.774862, 2618.675771, 2633.395387, 2646.47949, 2662.251436, 2629.928894, 2656.16086, 2662.11254, 2648.684804, 2662.39145, 2646.749421, 2667.733378, 2665.071862, 2643.45963, 2659.081563, 2645.77675, 2633.767303, 2623.791367, 2605.697552, 2584.992322, 2610.968257, 2570.051889, 2580.229454, 2584.803569, 2575.492071, 2561.810166, 2531.031208, 2513.550735, 2523.548062, 2508.46397, 2510.028678, 2514.932012, 2499.148025, 2502.359732, 2485.356416, 2488.673214, 2471.205968, 2480.177484, 2451.150313, 2446.167693, 2471.053199, 2475.935688, 2477.94371, 2475.579668, 2456.948652, 2448.019078, 2477.02261, 2471.788987, 2483.953328, 2497.817955, 2509.266545, 2519.045688, 2519.055047, 2519.065742, 2526.203968, 2533.704114, 2515.576192, 2540.43003, 2576.261688, 2586.88782, 2612.520932, 2605.284436, 2607.648341, 2606.71962, 2602.384918, 2638.175401, 2638.184759, 2677.859013, 2677.868371, 2683.807196, 2688.753519, 2680.774909, 2690.253035, 2717.527783, 2697.961229, 2749.94055, 2765.929855, 2733.690987, 2778.177047, 2764.635962, 2750.950706, 2731.175425, 2735.248868, 2751.097152, 2745.863529, 2739.882246, 2725.965931, 2702.008712, 2716.73192, 2695.713475, 2699.854572, 2668.169331, 2668.465925, 2645.214057, 2645.681971, 2612.902551, 2622.899877, 2594.719707, 2596.991527, 2546.937509, 2569.666453, 2544.225357, 2559.141925, 2514.35443, 2523.10209, 2485.58579, 2479.875533, 2467.572239, 2441.616357, 2458.289394, 2444.984581, 2434.148475, 2426.169865, 2415.245021, 2383.298497, 2363.158767, 2373.654088, 2364.5735, 2364.80728, 2371.859618, 2354.392372, 2324.384434, 2331.349668, 2331.360363, 2331.369722, 2328.423842, 2324.439885, 2321.484581, 2321.493939, 2321.504634, 2307.876621, 2293.269723, 2305.512704, 2293.837131, 2298.791048, 2331.254565, 2329.086358, 2327.189178, 2313.441961, 2297.139822, 2318.252659, 2335.417118, 2339.239553, 2338.874881, 2334.223812, 2315.538379, 2307.730751, 2302.415243, 2321.990524, 2325.812959, 2330.181457, 2326.771971, 2317.794698, 2309.939585, 2312.050483, 2292.884952, 2328.806337, 2304.849117, 2300.212942, 2331.724, 2331.733358, 2311.461978, 2307.47802, 2303.992058, 2288.903423, 2274.817525, 2258.977883, 2261.742407, 2257.798476, 2247.9662, 2256.71386, 2220.53768, 2230.588721, 2224.607438, 2199.957157, 2181.735572, 2161.179969, 2153.363454, 2163.629758, 2151.988047, 2134.759485, 2116.128469, 2082.243811, 2055.62349, 2043.736401, 2036.461034, 2029.471836, 1997.35511, 2010.245047, 1999.603336, 1928.087152, 1957.872725, 1953.000449, 1924.979582, 1901.809588, 1857.879107, 1879.118754, 1871.140145, 1864.158861, 1854.942897, 1844.966961, 1831.036695, 1792.242195, 1822.858415, 1798.901196, 1772.060055, 1740.970348, 1763.699292, 1718.477026, 1720.666622, 1721.89171, 1719.239303, 1710.694091, 1672.836427, 1650.519562, 1661.352613, 1646.526027, 1643.658193, 1647.66354, 1628.314821, 1628.325517, 1628.334875, 1612.673265, 1588.716045, 1612.122194, 1604.143584, 1597.162301, 1594.819197, 1596.827218, 1598.671431, 1598.682126, 1595.646097, 1558.958689, 1530.088388, 1544.080367, 1528.339188, 1531.879842, 1533.104962, 1511.384925, 1526.560824, 1504.602716, 1513.329017, 1519.479341, 1519.490036, 1519.500731, 1491.230629, 1488.818711, 1483.201353, 1451.254829, 1448.214559, 1446.476257, 1440.918999, 1428.945737, 1416.972475, 1394.079782, 1380.459646, 1391.089005, 1373.979761, 1353.439106, 1356.077105, 1347.466321, 1350.59511, 1355.351462, 1359.71996, 1333.678243, 1322.657027, 1312.906557, 1276.711497, 1244.764973, 1247.586816, 1259.391616, 1207.47183, 1232.231376, 1231.841438, 1197.211042, 1158.416543, 1181.345355, 1162.173295, 1144.897487, 1130.094327, 1142.093454, 1119.085016, 1087.138492, 1088.196274, 1047.636228, 1050.056424, 1014.00185, 1023.67004, 990.6172292, 997.1702349, 979.2049942, 985.9035942, 979.1953907, 973.5001868, 945.9727636, 960.3419894, 949.7002782, 933.8608706, 916.042373, 934.029004, 919.9621288, 923.6481727, 925.1122127, 910.2856275, 909.2906797, 910.0276753, 908.367377, 904.3834198, 900.4234058, 900.434101, 900.4447962, 899.6578148, 897.6711838, 895.6845528, 872.5178861, 884.8948271, 873.2531159, 860.7176612, 858.7310302, 856.7443992, 852.8080967, 848.1570271, 826.8904402, 800.8064289, 807.2474273, 811.6557632, 799.1118365, 823.2318115, 812.0608175, 814.203308, 788.6570078, 771.6904303, 781.9745237, 786.8203488, 780.8390653, 775.6054423, 769.6241589, 763.6428755, 760.4963877, 758.5097567, 756.0690203, 751.5870684, 744.8485126, 723.8886196, 736.77325, 705.7537474, 708.3005892, 694.3571622, 697.1243302, 689.1049452, 695.5747911, 699.3653885, 706.5444321, 660.0917158, 664.1891878, 667.4680189, 665.233059, 662.9980991, 660.7631392, 658.5281794, 629.7748724, 630.5272405, 620.8455231, 621.4292304, 620.3123694, 620.168861, 622.2416447, 615.5767612, 623.1028525, 607.732619, 603.2506671, 598.7687153, 592.0714539, 584.5948496, 562.5247951, 556.92657, 569.3659629, 561.8893586, 557.8059318, 555.5709719, 549.0420236, 534.0754461, 549.7670089, 554.6815689, 557.577344, 537.3664482, 514.9098974, 481.4195698, 491.3144033, 480.8162121, 474.1481843, 478.2456564, 479.9740333, 479.9860654, 479.9994344, 480.0114664, 474.1925322, 453.2326392, 474.6072613, 467.130657, 460.4017131, 453.6727693, 446.9438254, 443.4255959, 441.190636, 440.4709027, 440.4829347, 431.8234273, 416.8555129, 430.1421417, 427.7029098, 424.9245781, 419.9446316, 415.303965],
          referenceIntegration: 200,
        }],
        samples: [{
          name: 'Blue Dye',
          absorbance: [0.1898, 0.1924, 0.1976, 0.2015, 0.2041, 0.208, 0.2132, 0.2171, 0.2197, 0.2197, 0.2223, 0.2236, 0.2236, 0.2249, 0.2249, 0.2249, 0.2249, 0.2249, 0.2262, 0.2275, 0.2301, 0.2314, 0.234, 0.2366, 0.2392, 0.2431, 0.2457, 0.2483, 0.2509, 0.2522, 0.2548, 0.2561, 0.2574, 0.2574, 0.2574, 0.2574, 0.2561, 0.2548, 0.2535, 0.2522, 0.2496, 0.2444, 0.2418, 0.2392, 0.2366, 0.234, 0.2301, 0.2275, 0.2236, 0.221, 0.2171, 0.2145, 0.2106, 0.208, 0.2041, 0.2015, 0.1989, 0.1963, 0.1937, 0.1911, 0.1885, 0.1859, 0.182, 0.1794, 0.1768, 0.1742, 0.1729, 0.1703, 0.1677, 0.1638, 0.1625, 0.1599, 0.1573, 0.1547, 0.1534, 0.1508, 0.1495, 0.1469, 0.143, 0.1404, 0.1378, 0.1352, 0.1339, 0.1313, 0.1287, 0.1261, 0.1235, 0.1209, 0.1183, 0.117, 0.1144, 0.1131, 0.1105, 0.1092, 0.1066, 0.1053, 0.1027, 0.1001, 0.0975, 0.0949, 0.0936, 0.091, 0.0897, 0.0884, 0.0871, 0.0845, 0.0819, 0.0806, 0.0793, 0.078, 0.0767, 0.0741, 0.0728, 0.0715, 0.0689, 0.0676, 0.0663, 0.0663, 0.065, 0.0624, 0.0598, 0.0585, 0.0572, 0.0572, 0.0546, 0.0533, 0.052, 0.0507, 0.0494, 0.0481, 0.0468, 0.0455, 0.0442, 0.0442, 0.0429, 0.0429, 0.0416, 0.0403, 0.039, 0.039, 0.039, 0.0403, 0.0403, 0.0403, 0.0403, 0.0403, 0.0416, 0.0429, 0.0442, 0.0442, 0.0442, 0.0442, 0.0455, 0.0468, 0.0481, 0.0507, 0.0507, 0.0533, 0.0533, 0.0546, 0.0559, 0.0572, 0.0598, 0.0611, 0.0624, 0.065, 0.0663, 0.0689, 0.0702, 0.0728, 0.0741, 0.0754, 0.0754, 0.0767, 0.0793, 0.0819, 0.0845, 0.0871, 0.0897, 0.091, 0.091, 0.0923, 0.0949, 0.0988, 0.1027, 0.1079, 0.1092, 0.1105, 0.1131, 0.1157, 0.1196, 0.1222, 0.1248, 0.1287, 0.1313, 0.1339, 0.1365, 0.1404, 0.1456, 0.1495, 0.1534, 0.156, 0.1612, 0.1651, 0.1703, 0.1742, 0.1794, 0.1846, 0.1885, 0.1937, 0.1976, 0.2028, 0.208, 0.2145, 0.2197, 0.2249, 0.2314, 0.2366, 0.2431, 0.2496, 0.2548, 0.26, 0.2652, 0.2717, 0.2756, 0.2808, 0.286, 0.2925, 0.2977, 0.3042, 0.3094, 0.3159, 0.3211, 0.325, 0.3289, 0.3328, 0.338, 0.3419, 0.3471, 0.3536, 0.3588, 0.364, 0.3692, 0.3744, 0.3796, 0.3848, 0.3913, 0.3978, 0.4056, 0.4121, 0.4199, 0.4277, 0.4355, 0.4446, 0.4537, 0.4641, 0.4732, 0.4849, 0.4953, 0.5083, 0.52, 0.533, 0.5447, 0.559, 0.5733, 0.5876, 0.6019, 0.6175, 0.6344, 0.6513, 0.6682, 0.6851, 0.7007, 0.7189, 0.7371, 0.754, 0.7722, 0.7904, 0.8099, 0.8255, 0.8424, 0.8593, 0.8775, 0.8944, 0.9087, 0.923, 0.9347, 0.9464, 0.9568, 0.9672, 0.9737, 0.9802, 0.9854, 0.9893, 0.9906, 0.9906, 0.988, 0.9841, 0.9763, 0.9685, 0.9581, 0.9477, 0.9334, 0.9178, 0.9009, 0.8827, 0.8632, 0.8411, 0.819, 0.7956, 0.7722, 0.7462, 0.7215, 0.6942, 0.6682, 0.6422, 0.6162, 0.5889, 0.5616, 0.5369, 0.5109, 0.4862, 0.4602, 0.4355, 0.4121, 0.3887, 0.3666, 0.3471, 0.3263, 0.3081, 0.2912, 0.273, 0.2574, 0.2405, 0.2275, 0.2145, 0.2028, 0.1898, 0.1781, 0.1677, 0.1573, 0.1482, 0.1391, 0.1313, 0.1235, 0.1157, 0.1092, 0.1027, 0.0975, 0.0897, 0.0845, 0.0806, 0.0754, 0.0715, 0.0676, 0.0637, 0.0598, 0.0572, 0.0546, 0.052, 0.0481, 0.0455, 0.0429, 0.0403, 0.039, 0.0377, 0.0364, 0.0338, 0.0312, 0.0299, 0.0286, 0.0286, 0.0273, 0.026, 0.0247, 0.0234, 0.0221, 0.0221, 0.0221, 0.0208, 0.0208, 0.0182, 0.0182, 0.0169, 0.0169, 0.0169, 0.0169, 0.0169, 0.0156, 0.0156, 0.0143, 0.0156, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.013, 0.013, 0.013, 0.013, 0.013, 0.013, 0.0117, 0.0117, 0.0117, 0.013, 0.013, 0.013, 0.013, 0.013, 0.0117, 0.0117, 0.0117, 0.0117, 0.013, 0.0117, 0.0117, 0.0104, 0.0117, 0.0117, 0.0117, 0.0117, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0104, 0.0117, 0.0117, 0.0104, 0.0117, 0.0117, 0.0117, 0.0117, 0.0117, 0.0117, 0.0117, 0.0117, 0.013, 0.013, 0.013, 0.013, 0.0117, 0.013, 0.013, 0.013, 0.0143, 0.0143, 0.0143, 0.013, 0.013, 0.0117, 0.013, 0.013, 0.0143, 0.0143, 0.013, 0.0143, 0.013, 0.0143, 0.013, 0.0143, 0.0143, 0.0143, 0.013, 0.013, 0.013, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.0156, 0.0169, 0.0169, 0.0169, 0.0156, 0.0169, 0.0169, 0.0169, 0.0169, 0.0156, 0.0156, 0.0156, 0.0156, 0.0169, 0.0156, 0.0156, 0.0156, 0.0156, 0.0169, 0.0169, 0.0156, 0.0156, 0.0156, 0.0169, 0.0169, 0.0156, 0.0156, 0.0156, 0.0156, 0.0143, 0.0143, 0.0143, 0.0156, 0.0156, 0.0156, 0.0156, 0.0156, 0.0156, 0.0169, 0.0169, 0.0169, 0.0169, 0.0169, 0.0182, 0.0182, 0.0182, 0.0182, 0.0182, 0.0182, 0.0182, 0.0169, 0.0169, 0.0169, 0.0169, 0.0156, 0.0156, 0.0156, 0.0156, 0.0169, 0.0156, 0.0169, 0.0169, 0.0169, 0.0156, 0.0169, 0.0156, 0.0156, 0.0156, 0.0156, 0.0156, 0.0156, 0.0156, 0.0156, 0.0156, 0.0156, 0.0143, 0.0143, 0.013, 0.0143, 0.0143, 0.0156, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.0117, 0.0117, 0.0117, 0.013, 0.013, 0.013, 0.013, 0.013, 0.0143, 0.0143, 0.0143, 0.013, 0.013, 0.0143, 0.0143, 0.0143, 0.013, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.0156, 0.0156, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.0143, 0.0156, 0.013, 0.0117, 0.0117, 0.0117, 0.0104, 0.0091, 0.0104, 0.0117, 0.013, 0.0117, 0.0117, 0.0117, 0.0104, 0.0104, 0.0104, 0.0091, 0.0078, 0.0078, 0.0091, 0.0078, 0.0091, 0.0078, 0.0091, 0.0078, 0.0091, 0.0091, 0.0078, 0.0065, 0.0039],
          concentration: 1.04e-5,
        }],
        yarr: new Array(wavelengths.length).fill(0),

        datasets: [
          {
            label: 'Intensity',
            backgroundColor: '#249EBF',
            borderColor: '#249EBF',
            pointRadius: 0,
            fill: false,
            data: [],//new Array(this.wavelengths.length).fill(0),
          }
        ]
        ,
        options: {
          legend: false,
          tooltips: {
            intersect: false,
            axis: 'x',
            callbacks: {
              title: function(tooltipItem) {
                return 'Wavelength: ' + tooltipItem[0].xLabel + ' nm';
              }
            },
          },
          scales: {
            xAxes: [{
              type: 'linear',
              position: 'bottom',
              ticks: {
                min: 380,
                max: 900,
              },
              scaleLabel: {
                display: true,
                labelString: 'Wavelength (nm)',
              }
            }],
            yAxes: [{
              scaleLabel: {
                display: true,
                labelString: 'Intensity',
              },
              ticks: {
                suggestedMax: 3500,
              }
            }],

          },
          responsive: true,
          maintainAspectRatio: false
        }
      }
    },
    methods: {
      test() {

      },
      makePoints() {
        let pointsArr = [];
        for (let i = 0; i < this.yarr.length; i++) {
          pointsArr.push({x: this.wavelengths[i], y: this.yarr[i].toFixed(3)});
        }
        return pointsArr;
      },
      startLamp() {
        this.yarr = this.initLamp();
        this.state.lamp = true;
      },
      stopLamp() {
        this.yarr = new Array(this.wavelengths.length).fill(0);
        this.state.lamp = false;
      },
      initLamp() {
        let lamp = this.lamps[this.selected.lamp];
        return this.integratedIntensity(this.state.integration, this.state.saturation, lamp.intensity, lamp.referenceIntegration);
      },
      integratedIntensity(instrumentIntegration, instrumentSaturation, intensity, intensityIntegrationReference) {
        //Set values based on integration time
        intensity = intensity.map(x => x * instrumentIntegration / intensityIntegrationReference);
        //Simulate saturated detector if intensity is greater than saturation threshold
        this.state.saturationWarning = intensity.some(x => x > instrumentSaturation);
        this.state.lowLampWarning = Math.max(...intensity) < 0.5 * instrumentSaturation;
        intensity = intensity.map(x => x > instrumentSaturation ? instrumentSaturation : x);
        return intensity;
      },
    },
    computed: {
      integration() {
        return this.state.integration;
      },
      datacollection() {
        return {
          datasets: this.datasets,
        }
      },
    },
    watch: {
      integration() {
        this.startLamp();
      },
      yarr() {
        let set = this.datasets[0];
        set.data = this.makePoints();
        this.datasets.splice(0,1,set);
      }
    }
  }

</script>